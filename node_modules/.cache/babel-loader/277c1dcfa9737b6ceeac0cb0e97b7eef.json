{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/hurui/Desktop/project-SHP/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"C:/Users/hurui/Desktop/project-SHP/app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState, mapGetters } from 'vuex';\nexport default {\n  name: 'Trade',\n  data: function data() {\n    return {\n      sumTotalPrice: '',\n      orderComment: '',\n      orderId: ''\n    };\n  },\n  mounted: function mounted() {\n    this.$store.dispatch('reqGetOrderInfo');\n    this.$store.dispatch('reqGetUserLoca');\n  },\n  computed: _objectSpread(_objectSpread(_objectSpread({}, mapState({\n    location: function location(state) {\n      return state.order.location;\n    },\n    orderInfo: function orderInfo(state) {\n      return state.order.orderInfo;\n    }\n  })), mapGetters(['detailArrayList'])), {}, {\n    userSelectAddress: function userSelectAddress() {\n      console.log(this.location);\n      return this.location.find(function (item) {\n        return item.isDefault == 1;\n      });\n    }\n  }),\n  methods: {\n    selectAddress: function selectAddress(item, location) {\n      location.forEach(function (item) {\n        return item.isDefault = 0;\n      });\n      item.isDefault = 1;\n    },\n    SubmitOrder: function SubmitOrder() {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var tradeNo, data, result;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                tradeNo = _this.orderInfo.tradeNo;\n                data = {\n                  consignee: _this.userSelectAddress.consignee,\n                  consigneeTel: _this.userSelectAddress.phoneNum,\n                  deliveryAddress: _this.userSelectAddress.fullAddress,\n                  paymentWay: 'ONLINE',\n                  orderComment: _this.orderComment,\n                  orderDetailList: _this.detailArrayList\n                };\n                _context.next = 4;\n                return _this.$API.reqSubmitOrder(tradeNo, data);\n\n              case 4:\n                result = _context.sent;\n                console.log(result);\n\n                if (result.code == 200) {\n                  _this.orderId = result.data;\n\n                  _this.$router.push({\n                    name: 'pay',\n                    query: {\n                      orderId: _this.orderId\n                    }\n                  });\n                } else {\n                  alert('请求失败了');\n                }\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6GA;AACA;AACAA,eADA;AAEAC,MAFA,kBAEA;AACA;AACAC,uBADA;AAEAC,sBAFA;AAGAC;AAHA;AAKA,GARA;AASAC,SATA,qBASA;AACA;AACA;AACA,GAZA;AAaAC,0DACAC;AACAC;AAAA;AAAA,KADA;AAEAC;AAAA;AAAA;AAFA,IADA,GAKAC,+BALA;AAMAC,qBANA,+BAMA;AACAC;AACA;AAAA;AAAA;AACA;AATA,IAbA;AAwBAC;AACAC,iBADA,yBACAC,IADA,EACAP,QADA,EACA;AACAA;AAAA;AAAA;AACAO;AACA,KAJA;AAKAC,eALA,yBAKA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACAC,uBADA,GACA,eADA,CACAA,OADA;AAEAhB,oBAFA,GAEA;AACAiB,8DADA;AAEAC,gEAFA;AAGAC,sEAHA;AAIAC,sCAJA;AAKAlB,kDALA;AAMAmB;AANA,iBAFA;AAAA;AAAA,uBAWA,wCAXA;;AAAA;AAWAC,sBAXA;AAYAX;;AACA;AACA;;AACA;AAAAZ;AAAAwB;AAAApB;AAAA;AAAA;AACA,iBAHA,MAGA;AACAqB;AACA;;AAlBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmBA;AAxBA;AAxBA","names":["name","data","sumTotalPrice","orderComment","orderId","mounted","computed","mapState","location","orderInfo","mapGetters","userSelectAddress","console","methods","selectAddress","item","SubmitOrder","tradeNo","consignee","consigneeTel","deliveryAddress","paymentWay","orderDetailList","result","query","alert"],"sourceRoot":"src/pages/Trade","sources":["index.vue"],"sourcesContent":["<template>\n  <div class=\"trade-container\">\n    <h3 class=\"title\">填写并核对订单信息</h3>\n    <div class=\"content\">\n      <h5 class=\"receive\">收件人信息</h5>\n      <div class=\"address clearFix\" v-for=\"item in location\" :key=\"item.id\">\n        <span class=\"username\" :class=\"{ selected: item.isDefault == 1 }\">{{\n          item.consignee\n        }}</span>\n        <p @click=\"selectAddress(item, location)\">\n          <span class=\"s1\">{{ item.fullAddress }}</span>\n          <span class=\"s2\">{{ item.phoneNum }}</span>\n          <span class=\"s3\" v-show=\"item.isDefault == 1\">默认地址</span>\n        </p>\n      </div>\n      <div class=\"line\"></div>\n      <h5 class=\"pay\">支付方式</h5>\n      <div class=\"address clearFix\">\n        <span class=\"username selected\">在线支付</span>\n        <span class=\"username\" style=\"margin-left: 5px\">货到付款</span>\n      </div>\n      <div class=\"line\"></div>\n      <h5 class=\"pay\">送货清单</h5>\n      <div class=\"way\">\n        <h5>配送方式</h5>\n        <div class=\"info clearFix\">\n          <span class=\"s1\">天天快递</span>\n          <p>配送时间：预计8月10日（周三）09:00-15:00送达</p>\n        </div>\n      </div>\n      <div class=\"detail\">\n        <h5>商品清单</h5>\n        <ul\n          class=\"list clearFix\"\n          v-for=\"(item, index) in detailArrayList\"\n          :key=\"index\"\n        >\n          <li>\n            <img\n              alt=\"\"\n              :src=\"item.imgUrl\"\n              style=\"width: 100px; height: 100px\"\n            />\n          </li>\n          <li>\n            <p>\n              {{ item.skuName }}\n            </p>\n            <h4>7天无理由退货</h4>\n          </li>\n          <li>\n            <h3>￥{{ item.orderPrice }}</h3>\n          </li>\n          <li>X{{ item.skuNum }}</li>\n          <li>有货</li>\n        </ul>\n      </div>\n      <div class=\"bbs\">\n        <h5>买家留言：</h5>\n        <textarea\n          placeholder=\"建议留言前先与商家沟通确认\"\n          class=\"remarks-cont\"\n          v-model=\"orderComment\"\n        ></textarea>\n      </div>\n      <div class=\"line\"></div>\n      <div class=\"bill\">\n        <h5>发票信息：</h5>\n        <div>普通发票（电子） 个人 明细</div>\n        <h5>使用优惠/抵用</h5>\n      </div>\n    </div>\n    <div class=\"money clearFix\">\n      <ul>\n        <li>\n          <b\n            ><i>{{ orderInfo.totalNum }}</i\n            >件商品，总商品金额</b\n          >\n          <span>¥{{ orderInfo.totalAmount }}</span>\n        </li>\n        <li>\n          <b>返现：</b>\n          <span>0.00</span>\n        </li>\n        <li>\n          <b>运费：</b>\n          <span>0.00</span>\n        </li>\n      </ul>\n    </div>\n    <div class=\"trade\">\n      <div class=\"price\">\n        应付金额:　<span>{{ orderInfo.totalAmount }}</span>\n      </div>\n      <div class=\"receiveInfo\">\n        寄送至:\n        <span>{{ userSelectAddress.fullAddress }}</span>\n        收货人：<span>{{ userSelectAddress.consignee }}</span>\n        <span>{{ userSelectAddress.phoneNum }}</span>\n      </div>\n    </div>\n    <div class=\"sub clearFix\">\n      <a class=\"subBtn\" @click=\"SubmitOrder\">提交订单</a>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapGetters } from 'vuex'\nexport default {\n  name: 'Trade',\n  data() {\n    return {\n      sumTotalPrice: '',\n      orderComment: '',\n      orderId: '',\n    }\n  },\n  mounted() {\n    this.$store.dispatch('reqGetOrderInfo')\n    this.$store.dispatch('reqGetUserLoca')\n  },\n  computed: {\n    ...mapState({\n      location: (state) => state.order.location,\n      orderInfo: (state) => state.order.orderInfo,\n    }),\n    ...mapGetters(['detailArrayList']),\n    userSelectAddress() {\n      console.log(this.location)\n      return this.location.find((item) => item.isDefault == 1)\n    },\n  },\n  methods: {\n    selectAddress(item, location) {\n      location.forEach((item) => (item.isDefault = 0))\n      item.isDefault = 1\n    },\n    async SubmitOrder() {\n      const { tradeNo } = this.orderInfo\n      const data = {\n        consignee: this.userSelectAddress.consignee,\n        consigneeTel: this.userSelectAddress.phoneNum,\n        deliveryAddress: this.userSelectAddress.fullAddress,\n        paymentWay: 'ONLINE',\n        orderComment: this.orderComment,\n        orderDetailList: this.detailArrayList,\n      }\n\n      let result = await this.$API.reqSubmitOrder(tradeNo, data)\n      console.log(result)\n      if (result.code == 200) {\n        this.orderId = result.data\n        this.$router.push({ name: 'pay', query: { orderId: this.orderId } })\n      } else {\n        alert('请求失败了')\n      }\n    },\n  },\n}\n</script>\n\n<style lang=\"less\" scoped>\n.trade-container {\n  .title {\n    width: 1200px;\n    margin: 0 auto;\n    font-size: 14px;\n    line-height: 21px;\n  }\n\n  .content {\n    width: 1200px;\n    margin: 10px auto 0;\n    border: 1px solid rgb(221, 221, 221);\n    padding: 25px;\n    box-sizing: border-box;\n\n    .receive,\n    .pay {\n      line-height: 36px;\n      margin: 18px 0;\n    }\n\n    .address {\n      padding-left: 20px;\n      margin-bottom: 15px;\n\n      .username {\n        float: left;\n        width: 100px;\n        height: 30px;\n        line-height: 30px;\n        text-align: center;\n        border: 1px solid #ddd;\n        position: relative;\n      }\n\n      .username::after {\n        content: '';\n        display: none;\n        width: 13px;\n        height: 13px;\n        position: absolute;\n        right: 0;\n        bottom: 0;\n        background: url(./images/choosed.png) no-repeat;\n      }\n\n      .username.selected {\n        border-color: #e1251b;\n      }\n\n      .username.selected::after {\n        display: block;\n      }\n\n      p {\n        width: 610px;\n        float: left;\n        line-height: 30px;\n        margin-left: 10px;\n        padding-left: 5px;\n        cursor: pointer;\n\n        .s1 {\n          float: left;\n        }\n\n        .s2 {\n          float: left;\n          margin: 0 5px;\n        }\n\n        .s3 {\n          float: left;\n          width: 56px;\n          height: 24px;\n          line-height: 24px;\n          margin-left: 10px;\n          background-color: #878787;\n          color: #fff;\n          margin-top: 3px;\n          text-align: center;\n        }\n      }\n\n      p:hover {\n        background-color: #ddd;\n      }\n    }\n\n    .line {\n      height: 1px;\n      background-color: #ddd;\n    }\n\n    .way {\n      width: 1080px;\n      height: 110px;\n      background: #f4f4f4;\n      padding: 15px;\n      margin: 0 auto;\n\n      h5 {\n        line-height: 50px;\n      }\n\n      .info {\n        margin-top: 20px;\n\n        .s1 {\n          float: left;\n          border: 1px solid #ddd;\n          width: 120px;\n          height: 30px;\n          line-height: 30px;\n          text-align: center;\n          margin-right: 10px;\n        }\n\n        p {\n          line-height: 30px;\n        }\n      }\n    }\n\n    .detail {\n      width: 1080px;\n\n      background: #feedef;\n      padding: 15px;\n      margin: 2px auto 0;\n\n      h5 {\n        line-height: 50px;\n      }\n\n      .list {\n        display: flex;\n        justify-content: space-between;\n\n        li {\n          line-height: 30px;\n\n          p {\n            margin-bottom: 20px;\n          }\n\n          h4 {\n            color: #c81623;\n            font-weight: 400;\n          }\n\n          h3 {\n            color: #e12228;\n          }\n        }\n      }\n    }\n\n    .bbs {\n      margin-bottom: 15px;\n\n      h5 {\n        line-height: 50px;\n      }\n\n      textarea {\n        width: 100%;\n        border-color: #e4e2e2;\n        line-height: 1.8;\n        outline: none;\n        resize: none;\n      }\n    }\n\n    .bill {\n      h5 {\n        line-height: 50px;\n      }\n\n      div {\n        padding-left: 15px;\n      }\n    }\n  }\n\n  .money {\n    width: 1200px;\n    margin: 20px auto;\n\n    ul {\n      width: 220px;\n      float: right;\n\n      li {\n        line-height: 30px;\n        display: flex;\n        justify-content: space-between;\n\n        i {\n          color: red;\n        }\n      }\n    }\n  }\n\n  .trade {\n    box-sizing: border-box;\n    width: 1200px;\n    padding: 10px;\n    margin: 10px auto;\n    text-align: right;\n    background-color: #f4f4f4;\n    border: 1px solid #ddd;\n\n    div {\n      line-height: 30px;\n    }\n\n    .price span {\n      color: #e12228;\n      font-weight: 700;\n      font-size: 14px;\n    }\n\n    .receiveInfo {\n      color: #999;\n    }\n  }\n\n  .sub {\n    width: 1200px;\n    margin: 0 auto 10px;\n\n    .subBtn {\n      float: right;\n      width: 164px;\n      height: 56px;\n      font: 700 18px '微软雅黑';\n      line-height: 56px;\n      text-align: center;\n      color: #fff;\n      background-color: #e1251b;\n    }\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}