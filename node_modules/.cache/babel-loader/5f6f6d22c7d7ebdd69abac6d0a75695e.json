{"ast":null,"code":"import _asyncToGenerator from \"D:/vue3\\u7EC3\\u4E60/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport VueRouter from 'vue-router';\nimport Vue from 'vue';\nVue.use(VueRouter);\nimport store from '@/store';\nvar router = new VueRouter({\n  routes: [{\n    name: 'center',\n    path: '/center',\n    component: function component() {\n      return import('@/pages/Center');\n    },\n    meta: {\n      show: true\n    },\n    children: [{\n      name: 'myorder',\n      path: '/center/myorder',\n      component: function component() {\n        return import('@/pages/Center/myOrder');\n      },\n      meta: {\n        show: true\n      }\n    }, {\n      name: 'grouporder',\n      path: '/center/grouporder',\n      component: function component() {\n        return import('@/pages/Center/groupOrder');\n      },\n      meta: {\n        show: true\n      }\n    }, {\n      path: '/center',\n      redirect: '/center/myorder'\n    }]\n  }, {\n    name: 'paysuccess',\n    path: '/paysuccess',\n    component: function component() {\n      return import('@/pages/PaySuccess');\n    },\n    meta: {\n      show: true\n    },\n    beforeEnter: function beforeEnter(to, from, next) {\n      if (from.path == '/pay') {\n        next();\n      } else {\n        next(false);\n      }\n    }\n  }, {\n    name: 'pay',\n    path: '/pay',\n    component: function component() {\n      return import('@/pages/Pay');\n    },\n    meta: {\n      show: true\n    },\n    beforeEnter: function beforeEnter(to, from, next) {\n      if (from.path == '/trade') {\n        next();\n      } else {\n        next(false);\n      }\n    }\n  }, {\n    name: 'cartlist',\n    path: '/cartlist',\n    component: function component() {\n      return import('@/pages/ShopCart');\n    },\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'trade',\n    path: '/trade',\n    component: function component() {\n      return import('@/pages/Trade');\n    },\n    meta: {\n      show: true\n    },\n    beforeEnter: function beforeEnter(to, from, next) {\n      if (from.path == '/cartlist') {\n        next();\n      } else {\n        next(false);\n      }\n    }\n  }, {\n    name: 'addcartsuccess',\n    path: '/addcartsuccess',\n    component: function component() {\n      return import('@/pages/AddCartSuccess');\n    },\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'home',\n    path: '/home',\n    component: function component() {\n      return import('@/pages/Home');\n    },\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'detail',\n    path: '/detail/:skuid',\n    component: function component() {\n      return import('@/pages/Detail');\n    },\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'search',\n    path: '/search/:keyword?',\n    component: function component() {\n      return import('@/pages/Search');\n    },\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'login',\n    path: '/login',\n    component: function component() {\n      return import('@/pages/Login');\n    },\n    meta: {\n      show: false\n    }\n  }, {\n    name: 'register',\n    path: '/register',\n    component: function component() {\n      return import('@/pages/Register');\n    },\n    meta: {\n      show: false\n    }\n  }, {\n    path: '*',\n    redirect: '/home'\n  }],\n  scrollBehavior: function scrollBehavior(to, from, savedPosition) {\n    return {\n      y: 0\n    };\n  }\n}); // router.beforeEach((to, from, next) => {\n//   if (to.meta.title) {\n//     document.title = to.meta.title;\n//   }\n//   next();\n// })\n\nrouter.beforeEach( /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(to, from, next) {\n    var token, name, toPath;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            // next()\n            token = store.state.user.token;\n            name = store.state.user.userInfo.name;\n\n            if (!token) {\n              _context.next = 22;\n              break;\n            }\n\n            if (!(to.path == '/login')) {\n              _context.next = 7;\n              break;\n            }\n\n            next('/login');\n            _context.next = 20;\n            break;\n\n          case 7:\n            if (!name) {\n              _context.next = 11;\n              break;\n            }\n\n            next();\n            _context.next = 20;\n            break;\n\n          case 11:\n            _context.prev = 11;\n            _context.next = 14;\n            return store.dispatch('reqGetUserInfo');\n\n          case 14:\n            next();\n            _context.next = 20;\n            break;\n\n          case 17:\n            _context.prev = 17;\n            _context.t0 = _context[\"catch\"](11);\n            next('/login');\n\n          case 20:\n            _context.next = 24;\n            break;\n\n          case 22:\n            toPath = to.path;\n\n            if (toPath.indexOf('/center') !== -1 || toPath.indexOf('/pay') !== -1 || toPath.indexOf('/paysuccess') !== -1 || toPath.indexOf('/trade') !== -1) {\n              next('/login?redirect=' + toPath);\n            } else {\n              next();\n            }\n\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[11, 17]]);\n  }));\n\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}());\nexport default router;","map":{"version":3,"sources":["D:/vue3练习/app/src/router/index.js"],"names":["VueRouter","Vue","use","store","router","routes","name","path","component","meta","show","children","redirect","beforeEnter","to","from","next","scrollBehavior","savedPosition","y","beforeEach","token","state","user","userInfo","dispatch","toPath","indexOf"],"mappings":"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","sourcesContent":["import VueRouter from 'vue-router'\r\nimport Vue from 'vue'\r\n\r\nVue.use(VueRouter)\r\n\r\nimport store from '@/store'\r\n\r\nlet router = new VueRouter({\r\n  routes: [\r\n    {\r\n      name: 'center',\r\n      path: '/center',\r\n      component: () => import('@/pages/Center'),\r\n      meta: {\r\n        show: true,\r\n      },\r\n      children: [\r\n        {\r\n          name: 'myorder',\r\n          path: '/center/myorder',\r\n          component: () => import('@/pages/Center/myOrder'),\r\n          meta: { show: true },\r\n        },\r\n        {\r\n          name: 'grouporder',\r\n          path: '/center/grouporder',\r\n          component: () => import('@/pages/Center/groupOrder'),\r\n          meta: { show: true },\r\n        },\r\n        {\r\n          path: '/center',\r\n          redirect: '/center/myorder',\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: 'paysuccess',\r\n      path: '/paysuccess',\r\n      component: () => import('@/pages/PaySuccess'),\r\n      meta: { show: true },\r\n      beforeEnter: (to, from, next) => {\r\n        if (from.path == '/pay') {\r\n          next()\r\n        } else {\r\n          next(false)\r\n        }\r\n      },\r\n    },\r\n    {\r\n      name: 'pay',\r\n      path: '/pay',\r\n      component: () => import('@/pages/Pay'),\r\n      meta: { show: true },\r\n      beforeEnter: (to, from, next) => {\r\n        if (from.path == '/trade') {\r\n          next()\r\n        } else {\r\n          next(false)\r\n        }\r\n      },\r\n    },\r\n    {\r\n      name: 'cartlist',\r\n      path: '/cartlist',\r\n      component: () => import('@/pages/ShopCart'),\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'trade',\r\n      path: '/trade',\r\n      component: () => import('@/pages/Trade'),\r\n      meta: { show: true },\r\n      beforeEnter: (to, from, next) => {\r\n        if (from.path == '/cartlist') {\r\n          next()\r\n        } else {\r\n          next(false)\r\n        }\r\n      },\r\n    },\r\n    {\r\n      name: 'addcartsuccess',\r\n      path: '/addcartsuccess',\r\n      component: () => import('@/pages/AddCartSuccess'),\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'home',\r\n      path: '/home',\r\n      component: () => import('@/pages/Home'),\r\n      meta: {\r\n        show: true,\r\n      },\r\n    },\r\n    {\r\n      name: 'detail',\r\n      path: '/detail/:skuid',\r\n      component: () => import('@/pages/Detail'),\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'search',\r\n      path: '/search/:keyword?',\r\n      component: () => import('@/pages/Search'),\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'login',\r\n      path: '/login',\r\n      component: () => import('@/pages/Login'),\r\n      meta: { show: false },\r\n    },\r\n    {\r\n      name: 'register',\r\n      path: '/register',\r\n      component: () => import('@/pages/Register'),\r\n      meta: { show: false },\r\n    },\r\n    {\r\n      path: '*',\r\n      redirect: '/home',\r\n    },\r\n  ],\r\n  scrollBehavior(to, from, savedPosition) {\r\n    return { y: 0 }\r\n  },\r\n})\r\n\r\n// router.beforeEach((to, from, next) => {\r\n//   if (to.meta.title) {\r\n//     document.title = to.meta.title;\r\n//   }\r\n//   next();\r\n// })\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  // next()\r\n  let token = store.state.user.token\r\n  let name = store.state.user.userInfo.name\r\n  if (token) {\r\n    if (to.path == '/login') {\r\n      next('/login')\r\n    } else {\r\n      if (name) {\r\n        next()\r\n      } else {\r\n        try {\r\n          await store.dispatch('reqGetUserInfo')\r\n          next()\r\n        } catch (error) {\r\n          next('/login')\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    let toPath = to.path\r\n    if (\r\n      toPath.indexOf('/center') !== -1 ||\r\n      toPath.indexOf('/pay') !== -1 ||\r\n      toPath.indexOf('/paysuccess') !== -1 ||\r\n      toPath.indexOf('/trade') !== -1\r\n    ) {\r\n      next('/login?redirect=' + toPath)\r\n    } else {\r\n      next()\r\n    }\r\n  }\r\n})\r\n\r\nexport default router\r\n"]},"metadata":{},"sourceType":"module"}