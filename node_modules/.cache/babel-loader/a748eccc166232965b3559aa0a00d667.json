{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/hurui/Desktop/project-SHP/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport VueRouter from 'vue-router';\nimport Vue from 'vue';\nVue.use(VueRouter);\nimport Home from '@/pages/Home';\nimport Search from '@/pages/Search';\nimport Login from '@/pages/Login';\nimport Register from '@/pages/Register';\nimport Detail from '@/pages/Detail';\nimport ShopCart from '@/pages/ShopCart';\nimport AddCartSuccess from '@/pages/AddCartSuccess';\nimport store from '@/store';\nvar router = new VueRouter({\n  routes: [{\n    name: 'cartlist',\n    path: '/cartlist',\n    component: ShopCart,\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'addcartsuccess',\n    path: '/addcartsuccess',\n    component: AddCartSuccess,\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'home',\n    path: '/home',\n    component: Home,\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'detail',\n    path: '/detail/:skuid',\n    component: Detail,\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'search',\n    path: '/search/:keyword?',\n    component: Search,\n    meta: {\n      show: true\n    }\n  }, {\n    name: 'login',\n    path: '/login',\n    component: Login,\n    meta: {\n      show: false\n    }\n  }, {\n    name: 'register',\n    path: '/register',\n    component: Register,\n    meta: {\n      show: false\n    }\n  }, {\n    path: '*',\n    redirect: '/home'\n  }],\n  scrollBehavior: function scrollBehavior(to, from, savedPosition) {\n    return {\n      y: 0\n    };\n  }\n});\nrouter.beforeEach( /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(to, from, next) {\n    var token, name;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            next();\n            token = store.state.user.token;\n            name = store.state.userInfo;\n\n            if (!token) {\n              _context.next = 23;\n              break;\n            }\n\n            if (!(to.path == '/login')) {\n              _context.next = 8;\n              break;\n            }\n\n            next('/home');\n            _context.next = 21;\n            break;\n\n          case 8:\n            if (!name) {\n              _context.next = 12;\n              break;\n            }\n\n            next();\n            _context.next = 21;\n            break;\n\n          case 12:\n            _context.prev = 12;\n            _context.next = 15;\n            return state.dispatch('reqGetUserInfo');\n\n          case 15:\n            next();\n            _context.next = 21;\n            break;\n\n          case 18:\n            _context.prev = 18;\n            _context.t0 = _context[\"catch\"](12);\n            next('/login');\n\n          case 21:\n            _context.next = 24;\n            break;\n\n          case 23:\n            next();\n\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[12, 18]]);\n  }));\n\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}());\nexport default router;","map":{"version":3,"sources":["C:/Users/hurui/Desktop/project-SHP/app/src/router/index.js"],"names":["VueRouter","Vue","use","Home","Search","Login","Register","Detail","ShopCart","AddCartSuccess","store","router","routes","name","path","component","meta","show","redirect","scrollBehavior","to","from","savedPosition","y","beforeEach","next","token","state","user","userInfo","dispatch"],"mappings":"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","sourcesContent":["import VueRouter from 'vue-router'\r\nimport Vue from 'vue'\r\n\r\nVue.use(VueRouter)\r\n\r\nimport Home from '@/pages/Home'\r\nimport Search from '@/pages/Search'\r\nimport Login from '@/pages/Login'\r\nimport Register from '@/pages/Register'\r\nimport Detail from '@/pages/Detail'\r\nimport ShopCart from '@/pages/ShopCart'\r\nimport AddCartSuccess from '@/pages/AddCartSuccess'\r\nimport store from '@/store'\r\n\r\nlet router = new VueRouter({\r\n  routes: [\r\n    {\r\n      name: 'cartlist',\r\n      path: '/cartlist',\r\n      component: ShopCart,\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'addcartsuccess',\r\n      path: '/addcartsuccess',\r\n      component: AddCartSuccess,\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'home',\r\n      path: '/home',\r\n      component: Home,\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'detail',\r\n      path: '/detail/:skuid',\r\n      component: Detail,\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'search',\r\n      path: '/search/:keyword?',\r\n      component: Search,\r\n      meta: { show: true },\r\n    },\r\n    {\r\n      name: 'login',\r\n      path: '/login',\r\n      component: Login,\r\n      meta: { show: false },\r\n    },\r\n    {\r\n      name: 'register',\r\n      path: '/register',\r\n      component: Register,\r\n      meta: { show: false },\r\n    },\r\n    {\r\n      path: '*',\r\n      redirect: '/home',\r\n    },\r\n  ],\r\n  scrollBehavior(to, from, savedPosition) {\r\n    return { y: 0 }\r\n  },\r\n})\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  next()\r\n  let token = store.state.user.token\r\n  let name = store.state.userInfo\r\n  if (token) {\r\n    if (to.path == '/login') {\r\n      next('/home')\r\n    } else {\r\n      if (name) {\r\n        next()\r\n      } else {\r\n        try {\r\n          await state.dispatch('reqGetUserInfo')\r\n          next()\r\n        } catch (error) {\r\n          next('/login')\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    next()\r\n  }\r\n})\r\n\r\nexport default router\r\n"]},"metadata":{},"sourceType":"module"}